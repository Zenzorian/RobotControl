# –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –æ—à–∏–±–æ–∫ JSON –≤ —Ä–æ–±–æ—Ç–µ

## üêõ –û—à–∏–±–∫–∞: "–ù–µ–º–æ–∂–ª–∏–≤–æ –¥–µ–∫–æ–¥—É–≤–∞—Ç–∏ JSON –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è"

### üìä –¢–µ–ø–µ—Ä—å –ª–æ–≥–∏ –ø–æ–∫–∞–∂—É—Ç –±–æ–ª—å—à–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏:

**–°—Ç–∞—Ä—ã–π –ª–æ–≥:**
```
ERROR:robot:–ù–µ–º–æ–∂–ª–∏–≤–æ –¥–µ–∫–æ–¥—É–≤–∞—Ç–∏ JSON –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è
```

**–ù–æ–≤—ã–π –ª–æ–≥:**
```
ERROR:robot:–ù–µ–º–æ–∂–ª–∏–≤–æ –¥–µ–∫–æ–¥—É–≤–∞—Ç–∏ JSON –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è: 'OFFER!{...–æ—á–µ–Ω—å –¥–ª–∏–Ω–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ...}' –û—à–∏–±–∫–∞: Expecting value: line 1 column 1 (char 0)
```

### üîç –í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–∏—á–∏–Ω—ã –∏ —Ä–µ—à–µ–Ω–∏—è:

#### 1. **WebRTC —Å–∏–≥–Ω–∞–ª—å–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è (–ù–û–†–ú–ê)**
**–°–æ–æ–±—â–µ–Ω–∏—è:** `OFFER!{...}`, `ANSWER!{...}`, `CANDIDATE!{...}`

**–ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏–ª–æ:** –†–æ–±–æ—Ç –ø—ã—Ç–∞–ª—Å—è –ø–∞—Ä—Å–∏—Ç—å —ç—Ç–∏ —Å–æ–æ–±—â–µ–Ω–∏—è –∫–∞–∫ JSON
**–†–µ—à–µ–Ω–∏–µ:** ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –¥–æ –ø–æ–ø—ã—Ç–∫–∏ JSON –ø–∞—Ä—Å–∏–Ω–≥–∞

#### 2. **–°–æ–æ–±—â–µ–Ω–∏—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ (–ù–û–†–ú–ê)**
**–°–æ–æ–±—â–µ–Ω–∏—è:** `REGISTERED!CONTROLLER`, `REGISTERED!ROBOT`

**–ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏–ª–æ:** –†–æ–±–æ—Ç –ø—ã—Ç–∞–ª—Å—è –ø–∞—Ä—Å–∏—Ç—å –∫–∞–∫ JSON
**–†–µ—à–µ–Ω–∏–µ:** ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–∞ —Å–ø–µ—Ü–∏–∞–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞

#### 3. **–ü—É—Å—Ç—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è**
**–°–æ–æ–±—â–µ–Ω–∏—è:** `""`, `"   "`, `null`

**–ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏–ª–æ:** –ü–æ–ø—ã—Ç–∫–∞ –ø–∞—Ä—Å–∏—Ç—å –ø—É—Å—Ç—É—é —Å—Ç—Ä–æ–∫—É
**–†–µ—à–µ–Ω–∏–µ:** ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –ø—É—Å—Ç—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è

#### 4. **–ü–æ–≤—Ä–µ–∂–¥–µ–Ω–Ω—ã–µ JSON –∫–æ–º–∞–Ω–¥—ã**
**–°–æ–æ–±—â–µ–Ω–∏—è:** `COMMAND!{leftStickValue": {"x": 0.5` (–Ω–µ–ø–æ–ª–Ω—ã–π JSON)

**–ü—Ä–∏—á–∏–Ω—ã:**
- –°–µ—Ç–µ–≤—ã–µ –ø—Ä–æ–±–ª–µ–º—ã (–ø–æ—Ç–µ—Ä—è –ø–∞–∫–µ—Ç–æ–≤)
- –ü—Ä–æ–±–ª–µ–º—ã —Å –∫–æ–¥–∏—Ä–æ–≤–∫–æ–π
- –û—à–∏–±–∫–∏ –≤ Unity –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ

**–î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞:**
```
ERROR:robot:–ù–µ–º–æ–∂–ª–∏–≤–æ –¥–µ–∫–æ–¥—É–≤–∞—Ç–∏ JSON –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è: 'COMMAND!{leftStickValue": {"x": 0.5' –û—à–∏–±–∫–∞: Expecting ',' delimiter: line 1 column 25 (char 24)
```

#### 5. **–ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç –∫–æ–º–∞–Ω–¥**
**–°–æ–æ–±—â–µ–Ω–∏—è:** –∫–æ–º–∞–Ω–¥—ã –Ω–µ –≤ —Ñ–æ—Ä–º–∞—Ç–µ `COMMAND!{json}`

**–ü—Ä–∏–º–µ—Ä—ã –ø—Ä–æ–±–ª–µ–º–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π:**
- `{leftStickValue: {x: 0.5}}` (–±–µ–∑ –ø—Ä–µ—Ñ–∏–∫—Å–∞ COMMAND!)
- `COMMAND!leftStickValue=0.5` (–Ω–µ JSON —Ñ–æ—Ä–º–∞—Ç)

### üîß –£–ª—É—á—à–µ–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞

#### –ù–æ–≤—ã–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –≤ `_handle_message()`:

```python
# 1. –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—É—Å—Ç—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π
if not message or not message.strip():
    logger.warning("–û—Ç—Ä–∏–º–∞–Ω–æ –ø–æ—Ä–æ–∂–Ω—î –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è")
    return

# 2. –û–±—Ä–∞–±–æ—Ç–∫–∞ COMMAND! —Å–æ–æ–±—â–µ–Ω–∏–π
if message.startswith("COMMAND!"):
    json_data = message[8:]  # –£–±–∏—Ä–∞–µ–º COMMAND!
    data = json.loads(json_data)  # –ú–æ–∂–µ—Ç –≤—ã–∑–≤–∞—Ç—å JSONDecodeError
    
# 3. –û–±—Ä–∞–±–æ—Ç–∫–∞ –≤–∏–¥–µ–æ –∫–æ–º–∞–Ω–¥
if message == "REQUEST_VIDEO_STREAM":
    # –ù–µ JSON, –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º –æ—Ç–¥–µ–ª—å–Ω–æ
    
# 4. –û–±—Ä–∞–±–æ—Ç–∫–∞ WebRTC —Å–∏–≥–Ω–∞–ª–æ–≤
if message.startswith("OFFER!") or message.startswith("ANSWER!"):
    # –ù–µ JSON, –Ω–æ —Å–æ–¥–µ—Ä–∂–∞—Ç JSON –≤–Ω—É—Ç—Ä–∏
    
# 5. –û–±—Ä–∞–±–æ—Ç–∫–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏  
if message.startswith("REGISTERED!"):
    # –ù–µ JSON, —Ç–µ–∫—Å—Ç–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
    
# 6. –¢–æ–ª—å–∫–æ –ø–æ—Å–ª–µ –≤—Å–µ—Ö –ø—Ä–æ–≤–µ—Ä–æ–∫ - JSON –ø–∞—Ä—Å–∏–Ω–≥
data = json.loads(message)  # –ú–æ–∂–µ—Ç –≤—ã–∑–≤–∞—Ç—å JSONDecodeError
```

### üì± –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏

#### –í –ª–æ–≥–∞—Ö —Ä–æ–±–æ—Ç–∞ –∏—â–∏—Ç–µ:

**‚úÖ –ù–æ—Ä–º–∞–ª—å–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è:**
```
DEBUG:robot:–û—Ç—Ä–∏–º–∞–Ω–æ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è: COMMAND!{"leftStickValue":{"x":0.1,"y":0.2}}
DEBUG:robot:–û—Ç—Ä–∏–º–∞–Ω–æ WebRTC —Å–∏–≥–Ω–∞–ª—å–Ω–µ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è: OFFER!{"sdp":"v=0\r\n...
INFO:robot:–û—Ç—Ä–∏–º–∞–Ω–æ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è —Ä–µ—î—Å—Ç—Ä–∞—Ü—ñ—ó: REGISTERED!ROBOT
```

**‚ö†Ô∏è –ü—Ä–æ–±–ª–µ–º–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è:**
```
ERROR:robot:–ù–µ–º–æ–∂–ª–∏–≤–æ –¥–µ–∫–æ–¥—É–≤–∞—Ç–∏ JSON –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è: 'COMMAND!{leftStick' –û—à–∏–±–∫–∞: ...
WARNING:robot:–û—Ç—Ä–∏–º–∞–Ω–æ –ø–æ—Ä–æ–∂–Ω—î –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è
ERROR:robot:–ü–æ–º–∏–ª–∫–∞ –ø—Ä–∏ –æ–±—Ä–æ–±—Ü—ñ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è 'SOME_WEIRD_MESSAGE': ...
```

### üõ†Ô∏è –î–µ–π—Å—Ç–≤–∏—è –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö JSON

#### 1. **–ï—Å–ª–∏ –æ—à–∏–±–∫–∏ —Ä–µ–¥–∫–∏–µ (1-2 –≤ –º–∏–Ω—É—Ç—É):**
- –≠—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ, —Å–µ—Ç–µ–≤—ã–µ –ø–æ—Ç–µ—Ä–∏ –ø–∞–∫–µ—Ç–æ–≤
- –°–∏—Å—Ç–µ–º–∞ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏

#### 2. **–ï—Å–ª–∏ –æ—à–∏–±–∫–∏ —á–∞—Å—Ç—ã–µ (>10 –≤ –º–∏–Ω—É—Ç—É):**
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å–µ—Ç–µ–≤–æ–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ
- –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ —Å–µ—Ä–≤–µ—Ä –∏ —Ä–æ–±–æ—Ç–∞
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ Unity –∫–æ–¥ –æ—Ç–ø—Ä–∞–≤–∫–∏ –∫–æ–º–∞–Ω–¥

#### 3. **–ï—Å–ª–∏ –æ—à–∏–±–∫–∏ –ø–æ—Å—Ç–æ—è–Ω–Ω—ã–µ:**
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å –≤–µ—Ä—Å–∏–π
- –î–æ–±–∞–≤—å—Ç–µ `--debug` —Ñ–ª–∞–≥ –¥–ª—è –ø–æ–¥—Ä–æ–±–Ω—ã—Ö –ª–æ–≥–æ–≤
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ–¥–∏—Ä–æ–≤–∫—É —Å–æ–æ–±—â–µ–Ω–∏–π

### üöÄ –ö–æ–º–∞–Ω–¥—ã –¥–ª—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏

**–ü–æ–¥—Ä–æ–±–Ω—ã–µ –ª–æ–≥–∏:**
```bash
python3 robot_client.py --server ws://193.169.240.11:8080 --debug --use-motors
```

**–¢–µ—Å—Ç –±–µ–∑ –º–æ—Ç–æ—Ä–æ–≤:**
```bash
python3 robot_client.py --server ws://193.169.240.11:8080 --debug
```

**–¢–µ—Å—Ç —Å —Ç–µ—Å—Ç–æ–≤—ã–º –≤–∏–¥–µ–æ:**
```bash
python3 robot_client.py --server ws://193.169.240.11:8080 --debug --test-video
```

### üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

–°–ª–µ–¥–∏—Ç–µ –∑–∞ —ç—Ç–∏–º–∏ –ø–æ–∫–∞–∑–∞—Ç–µ–ª—è–º–∏ –≤ –ª–æ–≥–∞—Ö:
- **–ß–∞—Å—Ç–æ—Ç–∞ JSON –æ—à–∏–±–æ–∫** (–¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å <1% –æ—Ç –æ–±—â–µ–≥–æ —á–∏—Å–ª–∞ —Å–æ–æ–±—â–µ–Ω–∏–π)
- **–¢–∏–ø—ã –ø—Ä–æ–±–ª–µ–º–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π** (COMMAND!, OFFER!, etc.)
- **–í—Ä–µ–º—è –≤–æ–∑–Ω–∏–∫–Ω–æ–≤–µ–Ω–∏—è** (–µ—Å—Ç—å –ª–∏ –ø–∞—Ç—Ç–µ—Ä–Ω?)

–¢–µ–ø–µ—Ä—å –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ JSON –æ—à–∏–±–æ–∫ —Å—Ç–∞–ª–∞ –Ω–∞–º–Ω–æ–≥–æ –ø—Ä–æ—â–µ! üéØ 