# –û–±—ä–µ–¥–∏–Ω–µ–Ω–Ω—ã–π WebSocket + WebRTC –°–µ—Ä–≤–µ—Ä

## üéØ **–ß—Ç–æ –∏–∑–º–µ–Ω–∏–ª–æ—Å—å:**

–í–∞—à `index.js` —Ç–µ–ø–µ—Ä—å –æ–±—ä–µ–¥–∏–Ω—è–µ—Ç **–¥–≤–∞ —Å–µ—Ä–≤–µ—Ä–∞ –≤ –æ–¥–Ω–æ–º**:
- ‚úÖ **WebSocket —Å–µ—Ä–≤–µ—Ä** - –∫–æ–º–∞–Ω–¥—ã —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è, —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è (–∫–∞–∫ —Ä–∞–Ω—å—à–µ)
- ‚úÖ **WebRTC –º–µ–¥–∏–∞-—Å–µ—Ä–≤–µ—Ä** - —Ä–µ—Ç—Ä–∞–Ω—Å–ª—è—Ü–∏—è –≤–∏–¥–µ–æ (–Ω–æ–≤–æ–µ!)

## üèóÔ∏è **–ù–æ–≤–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞:**

```
Unity ‚Üê‚Üí WebSocket + WebRTC –°–µ—Ä–≤–µ—Ä ‚Üê‚Üí Robot
  ‚Üì              (–ø–æ—Ä—Ç 8080)              ‚Üë
  ‚Üì ‚Üê‚Üí –í–∏–¥–µ–æ–ø–æ—Ç–æ–∫ —á–µ—Ä–µ–∑ –≤–∞—à —Å–µ—Ä–≤–µ—Ä ‚Üê‚Üí   ‚Üë
```

## üõ†Ô∏è **–£—Å—Ç–∞–Ω–æ–≤–∫–∞:**

### 1. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ WebRTC –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å:
```bash
cd server
npm install wrtc
```

### 2. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –æ–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–π —Å–µ—Ä–≤–µ—Ä:
```bash
npm start
```

### 3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ WebRTC –∞–∫—Ç–∏–≤–µ–Ω:
```
‚úÖ WebRTC –º–æ–¥—É–ª—å –∑–∞–≥—Ä—É–∂–µ–Ω
üöÄ –û–±—ä–µ–¥–∏–Ω–µ–Ω–Ω—ã–π WebSocket + WebRTC —Å–µ—Ä–≤–µ—Ä –∑–∞–ø—É—â–µ–Ω –Ω–∞ –ø–æ—Ä—Ç—É 8080
üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–∞: http://localhost:8080/status
üé• WebRTC –º–µ–¥–∏–∞-—Ä–µ—Ç—Ä–∞–Ω—Å–ª—è—Ç–æ—Ä –∞–∫—Ç–∏–≤–µ–Ω
```

## üìä **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥:**

–û—Ç–∫—Ä–æ–π—Ç–µ –≤ –±—Ä–∞—É–∑–µ—Ä–µ: `http://localhost:8080/status`

**–û—Ç–≤–µ—Ç:**
```json
{
  "websocket": {
    "connections": 2,
    "controller": "connected",
    "robot": "connected"
  },
  "webrtc": {
    "enabled": true,
    "controller_connection": "active",
    "robot_connection": "active", 
    "media_streams": 1
  }
}
```

## üîÑ **–ß—Ç–æ –ù–ï –Ω—É–∂–Ω–æ –º–µ–Ω—è—Ç—å:**

### ‚ùå **–†–æ–±–æ—Ç (robot_client.py):**
- –ê–¥—Ä–µ—Å –æ—Å—Ç–∞–µ—Ç—Å—è —Ç–æ—Ç –∂–µ: `ws://–≤–∞—à_—Å–µ—Ä–≤–µ—Ä:8080`
- ICE —Å–µ—Ä–≤–µ—Ä—ã —Ä–∞–±–æ—Ç–∞—é—Ç –∫–∞–∫ —Ä–∞–Ω—å—à–µ
- –°–æ–æ–±—â–µ–Ω–∏—è –æ—Å—Ç–∞—é—Ç—Å—è —Ç–µ –∂–µ

### ‚ùå **Unity (RobotVideoProcessingService.cs):**
- –ê–¥—Ä–µ—Å –æ—Å—Ç–∞–µ—Ç—Å—è —Ç–æ—Ç –∂–µ: `ws://–≤–∞—à_—Å–µ—Ä–≤–µ—Ä:8080`
- ICE —Å–µ—Ä–≤–µ—Ä—ã —Ä–∞–±–æ—Ç–∞—é—Ç –∫–∞–∫ —Ä–∞–Ω—å—à–µ
- –°–æ–æ–±—â–µ–Ω–∏—è –æ—Å—Ç–∞—é—Ç—Å—è —Ç–µ –∂–µ

## ‚úÖ **–ß—Ç–æ —Å–µ—Ä–≤–µ—Ä —Ç–µ–ø–µ—Ä—å –¥–µ–ª–∞–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏:**

1. **–ü—Ä–∏ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ —Ä–æ–±–æ—Ç–∞:**
   ```
   ü§ñ –ö–ª–∏–µ–Ω—Ç —Ä–æ–±–æ—Ç–∞ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω
   üîó WebRTC robot: connecting
   ```

2. **–ü—Ä–∏ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ Unity:**
   ```
   üéÆ –ö–ª–∏–µ–Ω—Ç —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω
   üîó WebRTC controller: connecting
   ```

3. **–ü—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ –≤–∏–¥–µ–æ –æ—Ç —Ä–æ–±–æ—Ç–∞:**
   ```
   üé• –ü–æ–ª—É—á–µ–Ω –≤–∏–¥–µ–æ–ø–æ—Ç–æ–∫ –æ—Ç —Ä–æ–±–æ—Ç–∞
   üì° –†–µ—Ç—Ä–∞–Ω—Å–ª—è—Ü–∏—è –≤–∏–¥–µ–æ –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä—É
   üì§ OFFER –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä—É
   ```

4. **WebRTC —Å–∏–≥–Ω–∞–ª–∏–∑–∞—Ü–∏—è:**
   ```
   üì• OFFER –æ—Ç robot
   üì§ ANSWER –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω robot
   üßä ICE –∫–∞–Ω–¥–∏–¥–∞—Ç –¥–ª—è controller
   ```

## üéØ **–ì–ª–∞–≤–Ω—ã–µ –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**

1. **–û–¥–∏–Ω —Å–µ—Ä–≤–µ—Ä** –≤–º–µ—Å—Ç–æ –¥–≤—É—Ö
2. **–¢–æ—Ç –∂–µ –∫–æ–¥** —Ä–æ–±–æ—Ç–∞ –∏ Unity
3. **–í–∞—à —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–π TURN —Å–µ—Ä–≤–µ—Ä** - –≤–∏–¥–µ–æ –∏–¥–µ—Ç —á–µ—Ä–µ–∑ –≤–∞—à —Å–µ—Ä–≤–µ—Ä
4. **–ù–∏–∫–∞–∫–∏—Ö –≤–Ω–µ—à–Ω–∏—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π** –æ—Ç Google/Cloudflare TURN —Å–µ—Ä–≤–µ—Ä–æ–≤
5. **–ü–æ–ª–Ω—ã–π –∫–æ–Ω—Ç—Ä–æ–ª—å** –Ω–∞–¥ –≤–∏–¥–µ–æ–ø–æ—Ç–æ–∫–æ–º

## üîß **Troubleshooting:**

### –û—à–∏–±–∫–∞ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ wrtc:
```bash
# Windows:
npm install --global windows-build-tools
npm install wrtc

# Ubuntu/Debian:
sudo apt-get install build-essential python3-dev
npm install wrtc

# –ï—Å–ª–∏ –Ω–∏—á–µ–≥–æ –Ω–µ –ø–æ–º–æ–≥–∞–µ—Ç:
npm install wrtc --build-from-source
```

### WebRTC –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω:
```
‚ö†Ô∏è  WebRTC –º–æ–¥—É–ª—å –Ω–µ –Ω–∞–π–¥–µ–Ω - –≤–∏–¥–µ–æ —Ñ—É–Ω–∫—Ü–∏–∏ –±—É–¥—É—Ç –Ω–µ–¥–æ—Å—Ç—É–ø–Ω—ã
   –î–ª—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏: npm install wrtc
```
**–†–µ—à–µ–Ω–∏–µ:** –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ `wrtc` –∫–∞–∫ –æ–ø–∏—Å–∞–Ω–æ –≤—ã—à–µ

### –ù–µ—Ç –≤–∏–¥–µ–æ:
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ –≤ –ª–æ–≥–∞—Ö –µ—Å—Ç—å: `üé• WebRTC –º–µ–¥–∏–∞-—Ä–µ—Ç—Ä–∞–Ω—Å–ª—è—Ç–æ—Ä –∞–∫—Ç–∏–≤–µ–Ω`
2. –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Ä–æ–±–æ—Ç–∞ –∏ Unity –∫–∞–∫ –æ–±—ã—á–Ω–æ
3. –°–º–æ—Ç—Ä–∏—Ç–µ –ª–æ–≥–∏ —Å–µ—Ä–≤–µ—Ä–∞ –Ω–∞:
   - `üé• –ü–æ–ª—É—á–µ–Ω –≤–∏–¥–µ–æ–ø–æ—Ç–æ–∫ –æ—Ç —Ä–æ–±–æ—Ç–∞`
   - `üì° –†–µ—Ç—Ä–∞–Ω—Å–ª—è—Ü–∏—è –≤–∏–¥–µ–æ –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä—É`

### –í—ã—Å–æ–∫–∞—è –Ω–∞–≥—Ä—É–∑–∫–∞:
- –í–∏–¥–µ–æ —Ç–µ–ø–µ—Ä—å –∏–¥–µ—Ç —á–µ—Ä–µ–∑ –≤–∞—à —Å–µ—Ä–≤–µ—Ä - —ç—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Å–µ—Ä–≤–µ—Ä —Å —Ö–æ—Ä–æ—à–∏–º –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–æ–º
- –ú–æ–∂–Ω–æ –ø–æ–Ω–∏–∑–∏—Ç—å –∫–∞—á–µ—Å—Ç–≤–æ –≤–∏–¥–µ–æ –Ω–∞ —Ä–æ–±–æ—Ç–µ

## üß™ **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:**

1. **–ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–µ—Ä–≤–µ—Ä:**
   ```bash
   cd server
   npm start
   ```

2. **–ó–∞–ø—É—Å—Ç–∏—Ç–µ —Ä–æ–±–æ—Ç–∞ –∫–∞–∫ –æ–±—ã—á–Ω–æ:**
   ```bash
   cd Robot
   python robot_client.py --server ws://–≤–∞—à_—Å–µ—Ä–≤–µ—Ä:8080
   ```

3. **–ó–∞–ø—É—Å—Ç–∏—Ç–µ Unity –∫–∞–∫ –æ–±—ã—á–Ω–æ**

4. **–ò—â–∏—Ç–µ –≤ –ª–æ–≥–∞—Ö —Å–µ—Ä–≤–µ—Ä–∞:**
   ```
   ü§ñ –ö–ª–∏–µ–Ω—Ç —Ä–æ–±–æ—Ç–∞ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω
   üéÆ –ö–ª–∏–µ–Ω—Ç —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω
   üé• –ü–æ–ª—É—á–µ–Ω –≤–∏–¥–µ–æ–ø–æ—Ç–æ–∫ –æ—Ç —Ä–æ–±–æ—Ç–∞
   üì° –†–µ—Ç—Ä–∞–Ω—Å–ª—è—Ü–∏—è –≤–∏–¥–µ–æ –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä—É
   ```

## üéâ **–†–µ–∑—É–ª—å—Ç–∞—Ç:**

**–¢–µ–ø–µ—Ä—å –≤–∞—à —Å–µ—Ä–≤–µ—Ä = –ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω—ã–π –º–µ–¥–∏–∞-—Å–µ—Ä–≤–µ—Ä!**
- ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç –≤ –ª—é–±–æ–π —Å–µ—Ç–∏ (–≤–∞—à —Å–µ—Ä–≤–µ—Ä –∫–∞–∫ TURN)
- ‚úÖ –û–¥–∏–Ω —Å–µ—Ä–≤–µ—Ä –¥–ª—è –≤—Å–µ–≥–æ
- ‚úÖ –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ –∫–æ–¥–µ
- ‚úÖ –ü–æ–ª–Ω—ã–π –∫–æ–Ω—Ç—Ä–æ–ª—å –Ω–∞–¥ –≤–∏–¥–µ–æ–ø–æ—Ç–æ–∫–æ–º 